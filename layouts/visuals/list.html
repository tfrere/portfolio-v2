{{ define "main" }}
    <div class="visuals__container">
        <div class="visuals__container-content">
            <div class="visuals__container__introduction">
                {{ partial "shape" (dict "context" . "dotSize" 150) }}
                <h1 class="visuals__container__introduction__title">
                    <span class="word"><span class="word__content">Visuals</span></span>
                    </h1>
                <p class="visuals__container__introduction__desc">Random bits of decontextualized visuals from deep painting to graphism passing by photography.</p>
            </div>
            <div class="visuals__container__galleries">
                {{ range .Pages }} 
                    {{$title := .Title }}
                    <a href="{{ .RelPermalink }}" class="visuals__container__gallery-item nav-link">
                        {{ $images := .Resources }}
                        {{ with .Resources.ByType "image" }}
                            {{ range first 1 . }}
                                <div class="visuals__container__gallery-item__image three-dimensional-hover">
                                    <div class="visuals__container__gallery-item__image__canvas"></div>
                                    <div class="visuals__container__gallery-item__image__info-overlay">
                                        <h3 class="visuals__container__gallery-item__image__info-overlay__title">
                                            <span>{{ $title }}</span>
                                        </h3>
                                        <h5 class="visuals__container__gallery-item__image__info-overlay__desc">
                                            <span>{{ len $images }} images</span>
                                        </h5>
                                        
                                    </div>
                                    {{ partial "responsive-image" (dict "Site" $.Site "image" . "attrs" (dict "class" "portfolio-photo" )) }}
                                </div>
                            {{ end }}
                        {{ end }}
                        <div class="visuals__container__gallery-item__content hidden">
                            <h3 class="visuals__container__gallery-item__content__title">{{ .Title }}</h3>
                            {{ with .Params.tags }}
                                {{ range . }}
                                    {{ $href := print (absURL "tags/") (urlize .) }}
                                    {{ . }}
                                {{ end }}
                            {{ end }}
                            <p class="visuals__container__gallery-item__content__summary">{{ .Summary | replaceRE "<p>" "" | safeHTML }}</p>
                        </div>
                    </a>
                {{ end }}
            </div>
        </div>
    </div>
    <script>
        window.addEventListener("DOMContentLoaded", (event) => {
            $(function() {


                    var shapes = [
                        {
                        d:
                            "M10.7135105,97.0497966 C224.479278,110.844586 331.362162,117.74198 331.362162,117.74198 C331.362162,117.74198 513.713511,127.215679 513.713511,127.215679 C513.713511,127.215679 440.970091,470.113868 440.970091,470.113868 C440.970091,470.113868 43.4407909,503.049797 43.4407909,503.049797 C43.4407909,503.049797 32.5316974,367.716463 10.7135105,97.0497966 Z"
                        },
                        {
                        d:
                        "M-0.28648947,128.778075 C204.227804,113.10971 306.484951,105.275528 306.484951,105.275528 C306.484951,105.275528 533.713511,87.5042993 533.713511,87.5042993 C533.713511,87.5042993 494.034132,487.441005 494.034132,487.441005 C494.034132,487.441005 60.9052982,523.504299 60.9052982,523.504299 C60.9052982,523.504299 40.5080357,391.928891 -0.28648947,128.778075 Z"
                        }
                    ];

                    $(".shape").each(function () {
                        var shape = new MorphingShape($(this)[0], shapes);
                    });

                    var timeline = anime.timeline({
                    loop: false,
                    duration: 400,
                    });

                    anime.set(".word__content", {
                    translateY: "+=80px",
                    });

                    anime.set(".visuals__container__introduction__desc", {
                    translateY: "+=25px",
                    opacity:0
                    });

                    anime.set(".shape", {
                    translateY: "+=50px",
                    opacity:0
                    });

                    anime.set(".visuals__container__gallery-item", {
                    translateY: "+=25px",
                    opacity:0
                    });

                    var animation = timeline
                    .add({
                        targets: ".shape",
                        translateY: "-=50px",
                        easing: "easeOutQuart",
                        opacity:1,
                        duration: 450,
                    })
                    .add({
                        targets: ".word__content",
                        translateY: "-=80px",
                        easing: "easeOutQuart",
                        delay: anime.stagger(50),
                    }, "-=200")
                    .add({
                        targets: ".visuals__container__introduction__desc",
                        translateY: "-=25px",
                        easing: "easeOutQuart",
                        opacity:1,
                        delay: 100,
                        duration:250
                    }, "-=300")
                    .add({
                        targets: ".visuals__container__gallery-item",
                        translateY: "-=25px",
                        opacity:1,
                        duration:450,
                        easing: "easeOutQuart",
                        delay: anime.stagger(150),
                    }, "-=200");



                $(".visuals").mousewheel(function(evt, chg) {
                    // console.log(evt.originalEvent.wheelDeltaX);
                    // if (evt.originalEvent.wheelDeltaX < 10) {
                    //     this.scrollLeft -= (chg); //need a value to speed up the change
                    // }
                    this.scrollLeft -= (chg); //need a value to speed up the change
                    evt.preventDefault();
                });

                


                $(".three-dimensional-hover").mousemove(function (e) {
                    const force = 5;
                    const height = $(this).width();
                    const width = $(this).height();
                    var xVal = e.pageX - $(this).offset().left;
                    var yVal = e.pageY - $(this).offset().top;
                    const yRotation = force * ((xVal - width / 2) / width);
                    const xRotation = -force * ((yVal - height / 2) / height);
                    const string =
                    "perspective(500px) scale(1.03) rotateX(" +
                    xRotation +
                    "deg) rotateY(" +
                    yRotation +
                    "deg)";
                    $(this).css("transform", string);
                });

                $(".three-dimensional-hover").on("mouseout", function () {
                    $(this).css(
                    "transform",
                    "perspective(500px) scale(1) rotateX(0) rotateY(0)"
                    );
                });
            });
        });
    </script>
{{ end }}
